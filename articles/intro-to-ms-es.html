<!DOCTYPE HTML>
<html lang="en" class="light" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Introducción a Miniscript - Smart Vaults Book</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="Description">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body class="sidebar-visible no-js">
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('light')
            html.classList.add(theme);
            var body = document.querySelector('body');
            body.classList.remove('no-js')
            body.classList.add('js');
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var body = document.querySelector('body');
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            body.classList.remove('sidebar-visible');
            body.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="../index.html">Introduction</a></li><li class="chapter-item expanded affix "><li class="part-title">Release Notes</li><li class="chapter-item expanded "><a href="../release-notes/0.4.0.html"><strong aria-hidden="true">1.</strong> 0.4.0</a></li><li class="chapter-item expanded affix "><li class="part-title">Miniscript Templates</li><li class="chapter-item expanded "><a href="../miniscript-templates/decaying-multisig.html"><strong aria-hidden="true">2.</strong> Decaying Multisig</a></li><li class="chapter-item expanded "><a href="../miniscript-templates/m-of-n.html"><strong aria-hidden="true">3.</strong> Collaborative Custody</a></li><li class="chapter-item expanded "><a href="../miniscript-templates/hold.html"><strong aria-hidden="true">4.</strong> Hodl Lock</a></li><li class="chapter-item expanded "><a href="../miniscript-templates/social-recovery.html"><strong aria-hidden="true">5.</strong> Social Recovery / Inheritance</a></li><li class="chapter-item expanded affix "><li class="part-title">Nostr Specs</li><li class="chapter-item expanded "><a href="../kinds/index.html"><strong aria-hidden="true">6.</strong> Event Kinds</a></li><li class="chapter-item expanded affix "><li class="part-title">SDKs</li><li class="chapter-item expanded "><a href="../rust-sdk/01-getting-started.html"><strong aria-hidden="true">7.</strong> Rust SDK</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../rust-sdk/02-installation.html"><strong aria-hidden="true">7.1.</strong> Installation</a></li><li class="chapter-item expanded "><a href="../rust-sdk/03-features.html"><strong aria-hidden="true">7.2.</strong> Features</a></li><li class="chapter-item expanded "><a href="../rust-sdk/04-constructors.html"><strong aria-hidden="true">7.3.</strong> Constructors</a></li><li class="chapter-item expanded "><a href="../rust-sdk/05-configs-and-relays.html"><strong aria-hidden="true">7.4.</strong> Configs & Relays</a></li><li class="chapter-item expanded "><a href="../rust-sdk/06-profile-and-contacts.html"><strong aria-hidden="true">7.5.</strong> Profile & Contacts</a></li><li class="chapter-item expanded "><a href="../rust-sdk/07-signers.html"><strong aria-hidden="true">7.6.</strong> Signers</a></li><li class="chapter-item expanded "><a href="../rust-sdk/08-policies/01-index.html"><strong aria-hidden="true">7.7.</strong> Policies</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../rust-sdk/08-policies/02-templates.html"><strong aria-hidden="true">7.7.1.</strong> Templates</a></li><li class="chapter-item expanded "><a href="../rust-sdk/08-policies/03-custom-policies.html"><strong aria-hidden="true">7.7.2.</strong> Custom policies</a></li><li class="chapter-item expanded "><a href="../rust-sdk/08-policies/04-funding.html"><strong aria-hidden="true">7.7.3.</strong> Funding</a></li></ol></li><li class="chapter-item expanded "><a href="../rust-sdk/09-proposals.html"><strong aria-hidden="true">7.8.</strong> Proposals</a></li><li class="chapter-item expanded "><a href="../rust-sdk/10-connect.html"><strong aria-hidden="true">7.9.</strong> Connect</a></li><li class="chapter-item expanded "><a href="../rust-sdk/keychain/01-index.html"><strong aria-hidden="true">7.10.</strong> Keychain</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../rust-sdk/keychain/02-change-password.html"><strong aria-hidden="true">7.10.1.</strong> Change password</a></li><li class="chapter-item expanded "><a href="../rust-sdk/keychain/03-secrets.html"><strong aria-hidden="true">7.10.2.</strong> Secrets</a></li><li class="chapter-item expanded "><a href="../rust-sdk/keychain/04-wipe.html"><strong aria-hidden="true">7.10.3.</strong> Wipe</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="../js-sdk/01-getting-started.html"><strong aria-hidden="true">8.</strong> JavaScript SDK</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../js-sdk/02-contacts-and-profiles.html"><strong aria-hidden="true">8.1.</strong> contacts and profiles</a></li><li class="chapter-item expanded "><a href="../js-sdk/03-signers.html"><strong aria-hidden="true">8.2.</strong> signers</a></li><li class="chapter-item expanded "><a href="../js-sdk/04-vaults/01-vaults.html"><strong aria-hidden="true">8.3.</strong> vaults</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../js-sdk/04-vaults/02-creating-a-vault.html"><strong aria-hidden="true">8.3.1.</strong> creating vaults</a></li></ol></li><li class="chapter-item expanded "><a href="../js-sdk/05-proposals/01-creating-proposals.html"><strong aria-hidden="true">8.4.</strong> proposals</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../js-sdk/05-proposals/01-creating-proposals.html"><strong aria-hidden="true">8.4.1.</strong> creating proposals</a></li><li class="chapter-item expanded "><a href="../js-sdk/05-proposals/02-fetching-proposals.html"><strong aria-hidden="true">8.4.2.</strong> fetching proposals</a></li><li class="chapter-item expanded "><a href="../js-sdk/05-proposals/03-approvals.html"><strong aria-hidden="true">8.4.3.</strong> approving proposals</a></li><li class="chapter-item expanded "><a href="../js-sdk/05-proposals/04-finalizing-a-proposal.html"><strong aria-hidden="true">8.4.4.</strong> finalizing proposals</a></li></ol></li></ol></li><li class="chapter-item expanded "><li class="part-title">Articles</li><li class="chapter-item expanded "><a href="../articles/intro-to-ms-es.html" class="active"><strong aria-hidden="true">9.</strong> Introducción a Miniscript</a></li><li class="chapter-item expanded "><a href="../articles/intro-to-ms-en.html"><strong aria-hidden="true">10.</strong> Introduction to Miniscript</a></li><li class="chapter-item expanded "><a href="../articles/social-recovery.html"><strong aria-hidden="true">11.</strong> Social Recovery</a></li><li class="chapter-item expanded "><a href="../articles/inheritance.html"><strong aria-hidden="true">12.</strong> Inheritance</a></li><li class="chapter-item expanded affix "><li class="part-title">About</li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Smart Vaults Book</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/smartvaults/book" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                        <a href="https://github.com/smartvaults/book/edit/master/src/articles/intro-to-ms-es.md" title="Suggest an edit" aria-label="Suggest an edit">
                            <i id="git-edit-button" class="fa fa-edit"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <div align="center">
  <img src="../SV-Logo-Vertical-Black.svg" width=400/>
</div>
<h1 id="introducción-a-miniscript"><a class="header" href="#introducción-a-miniscript">Introducción a Miniscript</a></h1>
<h2 id="introducción"><a class="header" href="#introducción">Introducción</a></h2>
<p>En este artículo hablaremos sobre Miniscript, intentado cubrir las ideas principales, las cuales creemos de interés para cualquier persona que esté interesada en empezar a usar esta poderosa herramienta.</p>
<p>La mejor forma de introducirse a una tecnología nueva es, como sabemos, leyendo su documentación, la documentación más completa sin duda es la que podemos encontrar en: <a href="https://bitcoin.sipa.be/miniscript/">https://bitcoin.sipa.be/miniscript/</a> , escrita por Pieter Wuille, uno de los creadores de Miniscript, en ella encontramos la definición que utilizaremos en este artículo:</p>
<div style="text-align: center; font-style:italic ;">
“Miniscript is a language for writing (a subset of) Bitcoin Scripts in a structured way, enabling analysis, composition, generic signing and more”
</div>
<p>Cuya traducción literal al español es:</p>
<div style="text-align: center; font-style:italic ;">
“Miniscript es un lenguaje para escribir (un subconjunto de) Bitcoin Scripts de una manera estructurada, habilitando el análisis, composición, firmado genérico y más”
</div>
<p>Por lo tanto Miniscript es:</p>
<div style="text-align: center; font-style:italic ;">
Un lenguaje para escribir un subconjunto de Bitcoin Scripts.
</div>
<p>Primero, comenzaremos comentando sobre algunos de los conceptos que aparecen en la definición.</p>
<h2 id="bitcoin-script"><a class="header" href="#bitcoin-script">Bitcoin Script</a></h2>
<p>Si una divisa ha de ser de alguna utilidad, sin duda es necesario que esta pueda ser transferida.</p>
<p>Por lo tanto es necesario definir un mecanismo que permita tal transferencia. Adicionalmente, tal mecanismo debe poder asegurar el cumplimiento de ciertas condiciones, por ejemplo, que la persona que transfiere la divisa tenga el derecho de hacerlo.</p>
<p>En el caso de Bitcoin, el lenguaje que permite definir (y comprobar) estas condiciones se conoce como Bitcoin Script.</p>
<p>Bitcoin Script es un lenguaje de programación relativamente simple, pero que, como veremos, puede ser difícil de usar.</p>
<p>En las siguientes secciones, siempre que utilzemos la palabra <em>script</em> nos referiremos a un Bitcoin Script.</p>
<h2 id="estructura"><a class="header" href="#estructura">Estructura</a></h2>
<p>Todo lenguaje implica estructura, la estructura de miniscript, nos dice la definición, habilita entre otras cosas:</p>
<ol>
<li>Análisis</li>
<li>Composición</li>
</ol>
<h2 id="análisis"><a class="header" href="#análisis">Análisis</a></h2>
<p>El análisis es uno de esos conceptos que cuya definición es más clara cuando se le asigna un apellido.</p>
<p>Algunos de los análisis que Miniscript facilita son:</p>
<ul>
<li>Análisis de condiciones de gasto: ¿Cuáles son las condiciones de gasto de un script?</li>
<li>Análisis de seguridad: ¿Es posible que un script sea maleable?</li>
<li>Análisis de costos: ¿Cuál será el costo de usar un script?</li>
</ul>
<h2 id="composición"><a class="header" href="#composición">Composición</a></h2>
<p>La composición es el acto de juntar dos o más cosas para formar una nueva.</p>
<p>En el caso de Miniscript, la composición se refiere a la habilidad de juntar dos o más fragmentos (scripts) para formar uno nuevo.</p>
<h2 id="subconjunto"><a class="header" href="#subconjunto">Subconjunto</a></h2>
<p>Para bien o para mal la palabra subconjunto trae consigo una connotación intuitiva, y como toda intuición, no siempre está en lo correcto, un ejemplo bastará:</p>
<div style="text-align: center; font-style:italic ;">
El agua potable es un subconjunto de los líquidos
</div>
<p>Mientras que es cierto que el conjunto de los líquidos tiene mucho más que ofrecer que solo agua, es fácil ver porque en nuestro dia a dia nos interesa solo un subconjunto en particular.</p>
<p>Lo mismo es cierto en el caso de Miniscript: el subconjunto que se selecciona es tal que nos permite trabajar con Bitcoin Script sin preocuparnos de, por accidente o intención, "consumir líquidos nocivos para la salud".</p>
<p>Aunque el comentario anterior puede parecer trivial, en realidad, encapsula la motivación principal para usar miniscript:</p>
<div style="text-align: center; font-style:italic ;">
Usar Bitcoin Script es difícil.
</div>
<p>En particular, con Bitcoin Script es difícil realizar los análisis mencionados en la sección anterior, a decir:</p>
<ul>
<li>Determinar si un script es <em>correcto</em>.</li>
<li>Determinar si un script es seguro (i.e no es propenso a ser maleable).</li>
<li>Estimar fees (i.e tamaño de una transacción en el peor de los casos)</li>
</ul>
<p>Antes de continuar nuestra discusión, conviene introducir la siguiente definición:</p>
<p><strong>Condición de gasto:</strong> es el conjunto de condiciones mínimas que, al cumplirse, permiten usar con éxito un UTXO en una transacción</p>
<p>Por ejemplo:</p>
<ul>
<li>La condición (única) de gasto de una wallet single-sig es la firma del dueño de dicha wallet.</li>
<li>La condición (uńica) de gasto de una wallet musltisg 2 de 2, es la firma de las dos llaves involucradas.</li>
<li>Una (de dos en total) condición de gasto de una wallet multisig 1 de 2, es la firma de una de las llaves involucradas</li>
</ul>
<p>Mientras que algunos de los puntos, como el de seguridad, pueden (y muchas veces son) minimizados por restricciones a nivel de policy, Miniscript soluciona un problema más general:</p>
<div style="text-align: center; font-style:italic ;">
dado un Bitcoin Script, ¿Es posible, por medio de un análisis simple, determinar todas las posibles condiciones de gasto?
</div>
<p>La respuesta es, para la mayoría de nosotros: No.</p>
<p>Para convencernos, veamos el siguiente ejemplo:</p>
<p>Miniscript Policy <strong>(A)</strong>:</p>
<div style="text-align: center;">
and(pk(Alice),or(pk(Bob),or(9@pk(Charlie),after(1710526010))))
</div>
<p>Bitcoin Script <strong>(B)</strong>:</p>
<div style="text-align: center;">
  <img src="Script.jpeg" width=400/>
</div>
<p>Invitamos al lector a analizar por un momento la expresión <strong>(A)</strong>.</p>
<p>Asumiendo que una condición es de gasto, en el contexto de Miniscript, si toda la expresión, evaluada lógicamente, toma el valor de verdadero, debe resultar fácil convencerse de que las condiciones de gasto son:</p>
<ul>
<li>Firma de Alice y Firma Bob</li>
<li>Firma de Alice y Firma Charlie</li>
<li>Firma de Alice y el tiempo especificado (1710526010 unix time) ha transcurrido.</li>
</ul>
<p>Si las condiciones de gasto que mencionamos son ciertas, se sigue que:</p>
<ul>
<li>
<p>Los operadores <em>and</em> y <em>or</em> tienen un comportamiento similar al de sus homónimos lógicos (en caso de duda consulte las tablas de verdad para conjunciones y disyunciones)</p>
</li>
<li>
<p>Cada uno de sus elementos debe poder ser evaluado a un booleano (verdadero o falso)</p>
</li>
</ul>
<p>Sería incorrecto afirmar que las expresiones <strong>(A)</strong> Y <strong>(B)</strong> son equivalentes (recordemos nuestra breve digresión sobre subconjuntos), pero las <em>condiciones de gasto</em> expresadas en miniscript se conservan al pasar (con la ayuda de un compilador) de <strong>(A)</strong> a <strong>(B)</strong>.</p>
<h2 id="dos-miniscripts"><a class="header" href="#dos-miniscripts">¿Dos Miniscripts?</a></h2>
<p>Probablemente el lector habrá notado que en la sección anterior nos hemos referido a la expresión <strong>(A)</strong> como <strong>Miniscript Policy</strong> y no como <strong>Miniscript</strong>.</p>
<p>La razón es que son dos lenguajes diferentes.</p>
<p>La siguiente expresión <strong>(C):</strong></p>
<div style="text-align: center;">
and_v(or_c(pk(Bob),or_c(pk(Charlie),v:after(1710526010))),pk(Alice))
</div>
<p>Es el Miniscript que el Miniscript Policy <strong>(A)</strong> genera.</p>
<p>Examinemos de nuevo <strong>(A)</strong>:</p>
<div style="text-align: center;">
and(pk(Alice),or(pk(Bob),or(9@pk(Charlie),after(1710526010))))
</div>
<p>Notemos que las expresiones son muy similares, solo se eliminan algunas cosas de <strong>(A),</strong> como ese extraño ‘9@’ (del que hablaremos en la siguiente sección), se agregan otras como el  ‘v:’ y a los ‘and’ y ‘or’ se les agrega un par de caracteres (en realidad son tipos y modificadores).</p>
<p>Mientras que no entraremos a detalles sobre lo que significa cada uno de los cambios que ocurren cuando se pasa de <strong>(A)</strong> a <strong>(C)</strong>, vale la pena mencionar cómo ocurre esta transformación:</p>
<p>El Miniscript <strong>(C)</strong> se obtiene al compilar el Miniscript Policy <strong>(A)</strong></p>
<p>Naturalmente, el lector puede pensar que la razón de existir estos dos lenguajes es solo para evitarnos el trabajo de agregar todos esos caracteres (aparentemente necesarios) que aparecen en <strong>(A)</strong>, la razón resulta ser más fundamental:</p>
<div style="text-align: center;">
Existen diferentes formas (Bitcoin Scripts) de representar una misma condición de gasto.
</div>
<p>Para ilustrar el problema, consideremos una condición de gasto simple:</p>
<div style="text-align: center;">
pk(A)
</div>
<p>Podemos decir que existen al menos cuatro formas (opcodes) de comprobar esta condición:</p>
<ol>
<li>OP_CHECKSIG</li>
<li>OP_CHECKSIGVERIFY</li>
<li>OP_CHECKMULTISIG</li>
<li>OP_CHECKMULTISIGVERIFY</li>
</ol>
<p>En realidad basta con darnos cuenta que existen muchas formas de combinar los operadores 'and' y 'or' para expresar una condición dada.</p>
<p>Si hay varias opciones disponibles, tenemos la libertad de elegir ciertos parámetros de intéres para facilitar la elección, uno de ellos, del que hablaremos a continuación es:</p>
<div style="text-align: center;">
Optimización
</div>
<h2 id="probabilidades-y-optimización"><a class="header" href="#probabilidades-y-optimización">Probabilidades y Optimización</a></h2>
<p>Anteriormente mencionamos que para determinar las condiciones de gasto es útil pensar en que todos los elementos dentro de los operadores and y or deben poder ser evaluados a un booleano. Si asumimos que pk(A) es verdadero cuando se cuenta con una firma válida de A y falso cuando no, surge la pregunta:</p>
<p>¿Qué significa ‘N@pk(A)’ donde N es un número entero?</p>
<p>Empezaremos aclarando que ‘N@’ <strong>NO</strong> es un operador sobre el booleano pk(A):</p>
<p>N@pk(A) es verdadero si pk(A) es verdadero y falso si pk(A) es falso, sin importar el valor de N.</p>
<p>‘N@pk(A)’ es la notación para asignar a pk(A) una probabilidad relativa respecto a las otras condiciones que aparecen dentro de un mismo ‘or’.</p>
<p>Por lo tanto en la expresión <strong>(A),</strong> la presencia de ‘9@pk(Charlie)’ es para comunicarle al compilador, que la condición ‘pk(Charlie)’ es 9 veces más probable que la condición ‘after(1710526010)’.</p>
<p>Pero, ¿de qué sirve asignar probabilidades?</p>
<p>Como mencionamos en la sección anterior, dado un conjunto de posibles elecciones, nos conviene escoger aquella que, entre otras cosas, sea óptima.</p>
<p>Decimos que una elección es óptima si, al incluirla, el tamaño del Script resultante es el menor.</p>
<p>Al asignar probabilidades podemos comunicarle al compilador que una rama es más probable (o no) que las otras, en otras palabras, le decimos que le dé prioridad a optimizar ( reducir el tamaño) de la rama que es más probable, a costa de posiblemente incrementar el de la menor probabilidad.</p>
<h2 id="conclusión"><a class="header" href="#conclusión">Conclusión</a></h2>
<p>En este artículo hemos hablado un poco sobre la motivación para usar miniscript, así como de algunas de sus ideas principales, invitamos al lector a leer la documentación oficial si le interesa una introducción con mayor detalle.</p>
<p>En siguientes publicaciones hablaremos sobre Taproot y cómo se puede usar en conjunto con Miniscript.</p>
<p>Autor:</p>
<p><span style="font-weight: bold; color: blue;">Armando Medina</span></p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../js-sdk/05-proposals/04-finalizing-a-proposal.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../articles/intro-to-ms-en.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../js-sdk/05-proposals/04-finalizing-a-proposal.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../articles/intro-to-ms-en.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->
        <script src="../tabs.js"></script>


    </div>
    </body>
</html>
